import { useRef, useState, useEffect } from 'react';
import { Editor } from '@tinymce/tinymce-react';
import { useRouter } from 'next/router';
import authApi from '@/lib/authAxios';
import style from '@/styles/editor.module.css';

const boldIcon = `<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M8.85709 18.625C8.43531 18.625 8.07666 18.4772 7.78114 18.1817C7.48564 17.8862 7.33789 17.5275 7.33789 17.1058V6.8942C7.33789 6.47242 7.48564 6.11377 7.78114 5.81825C8.07666 5.52275 8.43531 5.375 8.85709 5.375H12.1994C13.2186 5.375 14.1401 5.69231 14.9638 6.32693C15.7875 6.96154 16.1994 7.81603 16.1994 8.89038C16.1994 9.63779 16.0189 10.2471 15.658 10.7183C15.2971 11.1894 14.9083 11.5314 14.4917 11.7442C15.0045 11.9211 15.4942 12.2708 15.9609 12.7933C16.4276 13.3157 16.6609 14.0192 16.6609 14.9038C16.6609 16.182 16.1897 17.1217 15.2474 17.723C14.3051 18.3243 13.3558 18.625 12.3994 18.625H8.85709ZM9.48782 16.6327H12.3186C13.1058 16.6327 13.6622 16.4141 13.9879 15.9769C14.3135 15.5397 14.4763 15.1205 14.4763 14.7192C14.4763 14.3179 14.3135 13.8987 13.9879 13.4615C13.6622 13.0243 13.0904 12.8057 12.2725 12.8057H9.48782V16.6327ZM9.48782 10.875H12.0821C12.6898 10.875 13.1715 10.7013 13.5273 10.3539C13.8831 10.0064 14.061 9.59037 14.061 9.10575C14.061 8.59035 13.8728 8.16918 13.4965 7.84225C13.1202 7.51533 12.659 7.35188 12.1128 7.35188H9.48782V10.875Z" fill="#8F95B2"/>
</svg>`;

const italicIcon = `<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M6.29836 18.625C6.04529 18.625 5.83139 18.5375 5.65666 18.3626C5.48191 18.1877 5.39453 17.9736 5.39453 17.7203C5.39453 17.467 5.48191 17.2532 5.65666 17.0788C5.83139 16.9045 6.04529 16.8173 6.29836 16.8173H9.21183L12.4522 7.18265H9.53876C9.28569 7.18265 9.07179 7.0952 8.89706 6.9203C8.72231 6.7454 8.63493 6.5313 8.63493 6.278C8.63493 6.02472 8.72231 5.81089 8.89706 5.63652C9.07179 5.46217 9.28569 5.375 9.53876 5.375H16.8849C17.138 5.375 17.3519 5.46245 17.5266 5.63735C17.7014 5.81225 17.7887 6.02634 17.7887 6.27962C17.7887 6.53293 17.7014 6.74676 17.5266 6.92113C17.3519 7.09548 17.138 7.18265 16.8849 7.18265H14.2791L11.0387 16.8173H13.6445C13.8976 16.8173 14.1115 16.9048 14.2862 17.0797C14.461 17.2546 14.5483 17.4687 14.5483 17.722C14.5483 17.9752 14.461 18.1891 14.2862 18.3634C14.1115 18.5378 13.8976 18.625 13.6445 18.625H6.29836Z" fill="#8F95B2"/>
</svg>`;

const underlineIcon = `<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M6.09568 20.1255C5.88319 20.1255 5.70508 20.0536 5.56133 19.9098C5.41758 19.766 5.3457 19.5878 5.3457 19.3752C5.3457 19.1626 5.41758 18.9845 5.56133 18.8409C5.70508 18.6973 5.88319 18.6255 6.09568 18.6255H17.9034C18.1159 18.6255 18.294 18.6974 18.4377 18.8413C18.5815 18.9851 18.6534 19.1633 18.6534 19.3759C18.6534 19.5884 18.5815 19.7665 18.4377 19.9101C18.294 20.0537 18.1159 20.1255 17.9034 20.1255H6.09568ZM11.9995 16.5294C10.4444 16.5294 9.23064 16.0573 8.3582 15.113C7.48577 14.1688 7.04955 12.9038 7.04955 11.3179V4.33326C7.04955 4.08093 7.14265 3.86465 7.32885 3.68441C7.51504 3.50418 7.73425 3.41406 7.9865 3.41406C8.23877 3.41406 8.45464 3.50418 8.63413 3.68441C8.81361 3.86465 8.90335 4.08093 8.90335 4.33326V11.4102C8.90335 12.4204 9.17194 13.2301 9.70913 13.839C10.2463 14.448 11.0098 14.7525 11.9995 14.7525C12.9893 14.7525 13.7527 14.448 14.2899 13.839C14.8271 13.2301 15.0957 12.4204 15.0957 11.4102V4.33326C15.0957 4.08093 15.1888 3.86465 15.375 3.68441C15.5612 3.50418 15.7804 3.41406 16.0327 3.41406C16.2849 3.41406 16.5008 3.50418 16.6803 3.68441C16.8598 3.86465 16.9495 4.08093 16.9495 4.33326V11.3179C16.9495 12.9038 16.5133 14.1688 15.6409 15.113C14.7684 16.0573 13.5546 16.5294 11.9995 16.5294Z" fill="#8F95B2"/>
</svg>`;

const bullistIcon = `<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M10.0577 18.7493C9.84518 18.7493 9.66705 18.6774 9.5233 18.5336C9.37957 18.3898 9.3077 18.2116 9.3077 17.999C9.3077 17.7864 9.37957 17.6083 9.5233 17.4648C9.66705 17.3212 9.84518 17.2494 10.0577 17.2494H19.75C19.9625 17.2494 20.1406 17.3213 20.2843 17.4651C20.4281 17.6089 20.5 17.7871 20.5 17.9997C20.5 18.2123 20.4281 18.3904 20.2843 18.534C20.1406 18.6775 19.9625 18.7493 19.75 18.7493H10.0577ZM10.0577 12.7493C9.84518 12.7493 9.66705 12.6774 9.5233 12.5336C9.37957 12.3898 9.3077 12.2116 9.3077 11.999C9.3077 11.7864 9.37957 11.6083 9.5233 11.4648C9.66705 11.3212 9.84518 11.2494 10.0577 11.2494H19.75C19.9625 11.2494 20.1406 11.3213 20.2843 11.4651C20.4281 11.6089 20.5 11.7871 20.5 11.9997C20.5 12.2123 20.4281 12.3904 20.2843 12.534C20.1406 12.6775 19.9625 12.7493 19.75 12.7493H10.0577ZM10.0577 6.74934C9.84518 6.74934 9.66705 6.67744 9.5233 6.53364C9.37957 6.38982 9.3077 6.21162 9.3077 5.99904C9.3077 5.78644 9.37957 5.60835 9.5233 5.46476C9.66705 5.32118 9.84518 5.24939 10.0577 5.24939H19.75C19.9625 5.24939 20.1406 5.32129 20.2843 5.46509C20.4281 5.6089 20.5 5.7871 20.5 5.99969C20.5 6.21229 20.4281 6.39038 20.2843 6.53396C20.1406 6.67754 19.9625 6.74934 19.75 6.74934H10.0577ZM5.16345 19.6628C4.706 19.6628 4.3144 19.4999 3.98865 19.1742C3.66288 18.8484 3.5 18.4568 3.5 17.9994C3.5 17.5419 3.66288 17.1503 3.98865 16.8246C4.3144 16.4988 4.706 16.3359 5.16345 16.3359C5.6209 16.3359 6.0125 16.4988 6.33825 16.8246C6.664 17.1503 6.82687 17.5419 6.82687 17.9994C6.82687 18.4568 6.664 18.8484 6.33825 19.1742C6.0125 19.4999 5.6209 19.6628 5.16345 19.6628ZM5.16345 13.6628C4.706 13.6628 4.3144 13.4999 3.98865 13.1742C3.66288 12.8484 3.5 12.4568 3.5 11.9994C3.5 11.5419 3.66288 11.1503 3.98865 10.8246C4.3144 10.4988 4.706 10.3359 5.16345 10.3359C5.6209 10.3359 6.0125 10.4988 6.33825 10.8246C6.664 11.1503 6.82687 11.5419 6.82687 11.9994C6.82687 12.4568 6.664 12.8484 6.33825 13.1742C6.0125 13.4999 5.6209 13.6628 5.16345 13.6628ZM5.16345 7.66279C4.706 7.66279 4.3144 7.49991 3.98865 7.17416C3.66288 6.84841 3.5 6.45681 3.5 5.99936C3.5 5.54191 3.66288 5.15031 3.98865 4.82456C4.3144 4.49881 4.706 4.33594 5.16345 4.33594C5.6209 4.33594 6.0125 4.49881 6.33825 4.82456C6.664 5.15031 6.82687 5.54191 6.82687 5.99936C6.82687 6.45681 6.664 6.84841 6.33825 7.17416C6.0125 7.49991 5.6209 7.66279 5.16345 7.66279Z" fill="#8F95B2"/>
</svg>`;

const numlistIcon = `<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M4.09615 21.5C3.92393 21.5 3.78152 21.4437 3.66892 21.3312C3.55631 21.2186 3.5 21.0763 3.5 20.9043C3.5 20.7322 3.55631 20.5897 3.66892 20.4769C3.78152 20.3641 3.92393 20.3077 4.09615 20.3077H6V19.25H5.09615C4.92393 19.25 4.78152 19.1937 4.66892 19.0812C4.55631 18.9686 4.5 18.8263 4.5 18.6543C4.5 18.4822 4.55631 18.3397 4.66892 18.2269C4.78152 18.1141 4.92393 18.0577 5.09615 18.0577H6V17H4.09615C3.92393 17 3.78152 16.9437 3.66892 16.8312C3.55631 16.7186 3.5 16.5763 3.5 16.4043C3.5 16.2322 3.55631 16.0897 3.66892 15.9769C3.78152 15.8641 3.92393 15.8077 4.09615 15.8077H6.34615C6.5859 15.8077 6.78686 15.8887 6.94903 16.0509C7.11121 16.2131 7.1923 16.4141 7.1923 16.6538V17.8461C7.1923 18.0859 7.11121 18.2868 6.94903 18.449C6.78686 18.6112 6.5859 18.6923 6.34615 18.6923C6.5859 18.6923 6.78686 18.7733 6.94903 18.9355C7.11121 19.0977 7.1923 19.2987 7.1923 19.5384V20.6538C7.1923 20.8935 7.11121 21.0945 6.94903 21.2567C6.78686 21.4189 6.5859 21.5 6.34615 21.5H4.09615ZM4.1827 14.8461C3.99168 14.8461 3.83014 14.7801 3.69807 14.6481C3.56602 14.516 3.5 14.3545 3.5 14.1634V12.25C3.5 12.0102 3.58109 11.8093 3.74327 11.6471C3.90546 11.4849 4.10642 11.4038 4.34615 11.4038H6V10.3461H4.09615C3.92393 10.3461 3.78152 10.2899 3.66892 10.1773C3.55631 10.0648 3.5 9.92251 3.5 9.75043C3.5 9.57834 3.55631 9.43588 3.66892 9.32305C3.78152 9.21023 3.92393 9.15383 4.09615 9.15383H6.34615C6.5859 9.15383 6.78686 9.23492 6.94903 9.3971C7.11121 9.55928 7.1923 9.76024 7.1923 9.99998V11.75C7.1923 11.9897 7.11121 12.1907 6.94903 12.3529C6.78686 12.515 6.5859 12.5961 6.34615 12.5961H4.6923V13.6538H6.59615C6.76837 13.6538 6.91078 13.7101 7.0234 13.8226C7.136 13.9351 7.1923 14.0774 7.1923 14.2495C7.1923 14.4216 7.136 14.5641 7.0234 14.6769C6.91078 14.7897 6.76837 14.8461 6.59615 14.8461H4.1827ZM5.5966 8.1923C5.42452 8.1923 5.28207 8.136 5.16925 8.0234C5.05642 7.91078 5 7.76837 5 7.59615V3.6923H4.09615C3.92393 3.6923 3.78152 3.63604 3.66892 3.52353C3.55631 3.41099 3.5 3.26868 3.5 3.0966C3.5 2.92452 3.55631 2.78207 3.66892 2.66925C3.78152 2.55642 3.92393 2.5 4.09615 2.5H5.51923C5.71024 2.5 5.87018 2.56443 5.99903 2.69328C6.12788 2.82213 6.1923 2.98206 6.1923 3.17308V7.59615C6.1923 7.76837 6.13604 7.91078 6.02352 8.0234C5.91099 8.136 5.76868 8.1923 5.5966 8.1923ZM10.0577 18.75C9.84518 18.75 9.66705 18.6781 9.5233 18.5343C9.37957 18.3904 9.3077 18.2122 9.3077 17.9997C9.3077 17.7871 9.37957 17.609 9.5233 17.4654C9.66705 17.3218 9.84518 17.25 10.0577 17.25H19.75C19.9625 17.25 20.1406 17.3219 20.2843 17.4657C20.4281 17.6095 20.5 17.7877 20.5 18.0003C20.5 18.2129 20.4281 18.391 20.2843 18.5346C20.1406 18.6782 19.9625 18.75 19.75 18.75H10.0577ZM10.0577 12.75C9.84518 12.75 9.66705 12.6781 9.5233 12.5343C9.37957 12.3904 9.3077 12.2122 9.3077 11.9997C9.3077 11.7871 9.37957 11.609 9.5233 11.4654C9.66705 11.3218 9.84518 11.25 10.0577 11.25H19.75C19.9625 11.25 20.1406 11.3219 20.2843 11.4657C20.4281 11.6095 20.5 11.7877 20.5 12.0003C20.5 12.2129 20.4281 12.391 20.2843 12.5346C20.1406 12.6782 19.9625 12.75 19.75 12.75H10.0577ZM10.0577 6.74995C9.84518 6.74995 9.66705 6.67805 9.5233 6.53425C9.37957 6.39043 9.3077 6.21223 9.3077 5.99965C9.3077 5.78705 9.37957 5.60896 9.5233 5.46538C9.66705 5.32179 9.84518 5.25 10.0577 5.25H19.75C19.9625 5.25 20.1406 5.3219 20.2843 5.4657C20.4281 5.60952 20.5 5.78772 20.5 6.0003C20.5 6.2129 20.4281 6.39099 20.2843 6.53458C20.1406 6.67816 19.9625 6.74995 19.75 6.74995H10.0577Z" fill="#8F95B2"/>
</svg>`;

const alignleftIcon = `<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M4.25 20.5C4.0375 20.5 3.85938 20.428 3.71563 20.2842C3.57188 20.1404 3.5 19.9622 3.5 19.7496C3.5 19.537 3.57188 19.3589 3.71563 19.2154C3.85938 19.0718 4.0375 19 4.25 19H19.75C19.9625 19 20.1406 19.0719 20.2843 19.2157C20.4281 19.3595 20.5 19.5377 20.5 19.7503C20.5 19.9629 20.4281 20.141 20.2843 20.2846C20.1406 20.4282 19.9625 20.5 19.75 20.5H4.25ZM4.25 16.625C4.0375 16.625 3.85938 16.553 3.71563 16.4092C3.57188 16.2654 3.5 16.0872 3.5 15.8746C3.5 15.662 3.57188 15.484 3.71563 15.3404C3.85938 15.1968 4.0375 15.125 4.25 15.125H13.75C13.9625 15.125 14.1406 15.1969 14.2843 15.3407C14.4281 15.4845 14.5 15.6627 14.5 15.8753C14.5 16.0879 14.4281 16.266 14.2843 16.4096C14.1406 16.5532 13.9625 16.625 13.75 16.625H4.25ZM4.25 12.75C4.0375 12.75 3.85938 12.6781 3.71563 12.5343C3.57188 12.3904 3.5 12.2122 3.5 11.9997C3.5 11.7871 3.57188 11.609 3.71563 11.4654C3.85938 11.3218 4.0375 11.25 4.25 11.25H19.75C19.9625 11.25 20.1406 11.3219 20.2843 11.4657C20.4281 11.6095 20.5 11.7877 20.5 12.0003C20.5 12.2129 20.4281 12.391 20.2843 12.5346C20.1406 12.6782 19.9625 12.75 19.75 12.75H4.25ZM4.25 8.87498C4.0375 8.87498 3.85938 8.80307 3.71563 8.65925C3.57188 8.51543 3.5 8.33723 3.5 8.12465C3.5 7.91205 3.57188 7.73396 3.71563 7.59038C3.85938 7.44679 4.0375 7.375 4.25 7.375H13.75C13.9625 7.375 14.1406 7.44691 14.2843 7.59073C14.4281 7.73453 14.5 7.91273 14.5 8.12533C14.5 8.33791 14.4281 8.51599 14.2843 8.65958C14.1406 8.80318 13.9625 8.87498 13.75 8.87498H4.25ZM4.25 4.99998C4.0375 4.99998 3.85938 4.92807 3.71563 4.78425C3.57188 4.64045 3.5 4.46225 3.5 4.24965C3.5 4.03707 3.57188 3.85898 3.71563 3.7154C3.85938 3.5718 4.0375 3.5 4.25 3.5H19.75C19.9625 3.5 20.1406 3.57191 20.2843 3.71573C20.4281 3.85954 20.5 4.03774 20.5 4.25033C20.5 4.46293 20.4281 4.64102 20.2843 4.7846C20.1406 4.92818 19.9625 4.99998 19.75 4.99998H4.25Z" fill="#8F95B2"/>
</svg>`;

const imageIcon = `<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M5.3077 20.5C4.80257 20.5 4.375 20.325 4.025 19.975C3.675 19.625 3.5 19.1974 3.5 18.6923V5.3077C3.5 4.80257 3.675 4.375 4.025 4.025C4.375 3.675 4.80257 3.5 5.3077 3.5H18.6923C19.1974 3.5 19.625 3.675 19.975 4.025C20.325 4.375 20.5 4.80257 20.5 5.3077V18.6923C20.5 19.1974 20.325 19.625 19.975 19.975C19.625 20.325 19.1974 20.5 18.6923 20.5H5.3077ZM5.3077 19H18.6923C18.7692 19 18.8397 18.9679 18.9038 18.9038C18.9679 18.8397 19 18.7692 19 18.6923V5.3077C19 5.23077 18.9679 5.16024 18.9038 5.09613C18.8397 5.03203 18.7692 4.99998 18.6923 4.99998H5.3077C5.23077 4.99998 5.16024 5.03203 5.09612 5.09613C5.03202 5.16024 4.99997 5.23077 4.99997 5.3077V18.6923C4.99997 18.7692 5.03202 18.8397 5.09612 18.9038C5.16024 18.9679 5.23077 19 5.3077 19ZM7.65388 16.75H16.423C16.6038 16.75 16.7377 16.6679 16.8249 16.5038C16.9121 16.3397 16.8987 16.1807 16.7845 16.0269L14.4 12.8327C14.3064 12.7122 14.1859 12.6519 14.0384 12.6519C13.891 12.6519 13.7705 12.7122 13.6769 12.8327L11.2308 16.0192L9.5923 13.9192C9.49872 13.8051 9.37981 13.7481 9.23558 13.7481C9.09134 13.7481 8.97243 13.8083 8.87885 13.9289L7.30195 16.0269C7.18143 16.1807 7.16477 16.3397 7.25195 16.5038C7.33913 16.6679 7.47311 16.75 7.65388 16.75Z" fill="#8F95B2"/>
</svg>`;

const videoIcon = `<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M9.49021 12.75V15C9.49021 15.2128 9.562 15.391 9.70559 15.5346C9.84917 15.6782 10.0274 15.75 10.2402 15.75C10.453 15.75 10.6312 15.6782 10.7748 15.5346C10.9184 15.391 10.9902 15.2128 10.9902 15V12.75H13.2402C13.453 12.75 13.6312 12.6782 13.7748 12.5346C13.9184 12.391 13.9902 12.2128 13.9902 12C13.9902 11.7872 13.9184 11.609 13.7748 11.4654C13.6312 11.3218 13.453 11.25 13.2402 11.25H10.9902V8.99998C10.9902 8.78716 10.9184 8.60896 10.7748 8.46538C10.6312 8.32179 10.453 8.25 10.2402 8.25C10.0274 8.25 9.84917 8.32179 9.70559 8.46538C9.562 8.60896 9.49021 8.78716 9.49021 8.99998V11.25H7.24018C7.02737 11.25 6.84917 11.3218 6.70558 11.4654C6.562 11.609 6.49021 11.7872 6.49021 12C6.49021 12.2128 6.562 12.391 6.70558 12.5346C6.84917 12.6782 7.02737 12.75 7.24018 12.75H9.49021ZM4.54791 19.5C4.04278 19.5 3.61521 19.325 3.26521 18.975C2.91523 18.625 2.74023 18.1974 2.74023 17.6923V6.3077C2.74023 5.80257 2.91523 5.375 3.26521 5.025C3.61521 4.675 4.04278 4.5 4.54791 4.5H15.9325C16.4376 4.5 16.8652 4.675 17.2152 5.025C17.5652 5.375 17.7402 5.80257 17.7402 6.3077V10.8846L20.4863 8.1385C20.6337 7.99107 20.7994 7.95421 20.9834 8.02793C21.1674 8.10164 21.2593 8.24234 21.2593 8.45003V15.5499C21.2593 15.7576 21.1674 15.8983 20.9834 15.972C20.7994 16.0457 20.6337 16.0089 20.4863 15.8615L17.7402 13.1153V17.6923C17.7402 18.1974 17.5652 18.625 17.2152 18.975C16.8652 19.325 16.4376 19.5 15.9325 19.5H4.54791ZM4.54791 18H15.9325C16.0222 18 16.096 17.9711 16.1536 17.9134C16.2113 17.8557 16.2402 17.782 16.2402 17.6923V6.3077C16.2402 6.21795 16.2113 6.14423 16.1536 6.08652C16.096 6.02882 16.0222 5.99998 15.9325 5.99998H4.54791C4.45816 5.99998 4.38443 6.02882 4.32673 6.08652C4.26903 6.14423 4.24018 6.21795 4.24018 6.3077V17.6923C4.24018 17.782 4.26903 17.8557 4.32673 17.9134C4.38443 17.9711 4.45816 18 4.54791 18Z" fill="#8F95B2"/>
</svg>`;

const linkIcon = `<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M11.7017 18.7169C10.8138 19.6048 9.74414 20.0488 8.49265 20.0489C7.24115 20.049 6.17152 19.6051 5.28376 18.7174C4.396 17.8296 3.95203 16.7598 3.95185 15.5081C3.95168 14.2563 4.39552 13.1865 5.28339 12.2986L7.4183 10.1637C7.56856 10.0135 7.74536 9.93837 7.94868 9.93843C8.15201 9.93846 8.32884 10.0136 8.47917 10.164C8.62949 10.3143 8.70459 10.491 8.70448 10.6942C8.70437 10.8974 8.62919 11.0741 8.47893 11.2244L6.3432 13.3601C5.74995 13.9533 5.45332 14.6692 5.45332 15.5078C5.45332 16.3464 5.75022 17.0625 6.34401 17.6563C6.93781 18.2501 7.65398 18.547 8.49254 18.547C9.3311 18.547 10.047 18.2504 10.6403 17.6571L12.776 15.5214C12.9262 15.3711 13.103 15.296 13.3063 15.2961C13.5097 15.2961 13.6865 15.3713 13.8368 15.5216C13.9872 15.672 14.0623 15.8487 14.0622 16.0519C14.062 16.2551 13.9869 16.4318 13.8366 16.582L11.7017 18.7169ZM10.4099 14.6511C10.2596 14.8014 10.0828 14.8765 9.87949 14.8764C9.67615 14.8764 9.49932 14.8012 9.349 14.6509C9.19867 14.5005 9.12357 14.3238 9.12369 14.1206C9.12379 13.9174 9.19897 13.7407 9.34923 13.5905L13.5919 9.34783C13.7421 9.19757 13.9189 9.12246 14.1223 9.1225C14.3256 9.12255 14.5024 9.19774 14.6527 9.34806C14.8031 9.49839 14.8782 9.67514 14.8781 9.8783C14.8779 10.0815 14.8028 10.2582 14.6525 10.4085L10.4099 14.6511ZM16.5834 13.8352C16.4332 13.9855 16.2564 14.0606 16.053 14.0605C15.8497 14.0605 15.6729 13.9853 15.5226 13.835C15.3722 13.6846 15.2971 13.5079 15.2973 13.3047C15.2974 13.1016 15.3725 12.9248 15.5228 12.7746L17.6585 10.6389C18.2518 10.0456 18.5484 9.3297 18.5484 8.49114C18.5484 7.65258 18.2515 6.9364 17.6577 6.34261C17.0639 5.74882 16.3478 5.45192 15.5092 5.45192C14.6706 5.45192 13.9547 5.74855 13.3615 6.3418L11.2258 8.47753C11.0755 8.62779 10.8987 8.70289 10.6954 8.70285C10.492 8.7028 10.3152 8.62762 10.1649 8.4773C10.0146 8.32697 9.93946 8.15021 9.93958 7.94704C9.93969 7.74387 10.0149 7.56716 10.1651 7.4169L12.3 5.28199C13.1879 4.39412 14.2576 3.95015 15.5091 3.95006C16.7606 3.94998 17.8302 4.39382 18.718 5.28158C19.6057 6.16934 20.0497 7.2391 20.0499 8.49086C20.0501 9.74261 19.6062 10.8124 18.7183 11.7003L16.5834 13.8352Z" fill="#8F95B2"/>
</svg>`;

interface TinyMceEditorProps {
  code: string;
}

const addCustomButton = (
  editor: any,
  iconName: string,
  icon: string,
  tooltipText: string,
  command: string
) => {
  editor.ui.registry.addIcon(iconName, icon);
  editor.ui.registry.addButton(iconName, {
    icon: iconName,
    tooltip: tooltipText,
    onAction: () => editor.execCommand(command),
  });
};

const TinyMceEditor = ({ code }: TinyMceEditorProps) => {
  const editorRef = useRef<any>(null);
  const router = useRouter();
  const [content, setContent] = useState<string>('');

  useEffect(() => {
    const fetchContent = async () => {
      try {
        const response = await authApi.get(`/profiles/${code}`);
        setContent(response.data.content);
      } catch (error) {
        console.error('실패', error);
      }
    };
    fetchContent();
  }, [code]);

  const saveContent = async () => {
    if (editorRef.current) {
      const editorContent = editorRef.current.getContent();
      setContent(editorContent);

      try {
        await authApi.post(`/profiles/${code}/ping`, {
          securityAnswer: '빨간색',
        });

        await authApi.patch(`/profiles/${code}`, {
          content: editorContent,
        });
        alert('저장 성공!');
        router.push(`/wiki/${code}`);
      } catch (error) {
        alert('저장 실패');
      }
    }
  };

  const tinymcePlugins = [
    'link',
    'lists',
    'autoresize',
    'media',
    'quickbars',
    'image',
  ];
  const tinymceToolbar =
    'customBold customItalic customUnderline |' +
    'blocks customBullist customNumlist |' +
    'customAlignleft |' +
    'customImage customVideo customLink';

  return (
    <div>
      <Editor
        apiKey={process.env.NEXT_PUBLIC_TINYMCE_API_KEY}
        onInit={(evt, editor) => (editorRef.current = editor)}
        initialValue={
          content ||
          `<h2>01. 개요</h2>
          <p>여기에 기본 내용을 입력하세요.</p>
          <h2>02. 취미</h2>
          <p>여기에 취미에 관한 내용을 입력하세요.</p>
          <h2>03. 여담</h2>
          <p>여기에 여담에 관한 내용을 입력하세요.</p>
          <h2>04. 취향</h2>
          <p>여기에 취향에 관한 내용을 입력하세요.</p>
        `
        }
        init={{
          plugins: tinymcePlugins,
          toolbar: tinymceToolbar,
          min_height: 500,
          menubar: false,
          branding: false,
          statusbar: false,
          block_formats: '제목1=h2;제목2=h3;제목3=h4;내용=p;',
          setup: (editor) => {
            addCustomButton(editor, 'customBold', boldIcon, 'Bold', 'Bold');
            addCustomButton(
              editor,
              'customItalic',
              italicIcon,
              'Italic',
              'Italic'
            );
            addCustomButton(
              editor,
              'customUnderline',
              underlineIcon,
              'Underline',
              'Underline'
            );
            addCustomButton(
              editor,
              'customBullist',
              bullistIcon,
              'Bullet list',
              'InsertUnorderedList'
            );
            addCustomButton(
              editor,
              'customNumlist',
              numlistIcon,
              'Numbered list',
              'InsertOrderedList'
            );
            addCustomButton(
              editor,
              'customAlignleft',
              alignleftIcon,
              'Align left',
              'JustifyLeft'
            );
            addCustomButton(
              editor,
              'customImage',
              imageIcon,
              'Insert Image',
              'mceImage'
            );
            addCustomButton(
              editor,
              'customVideo',
              videoIcon,
              'Media',
              'mceMedia'
            );
            addCustomButton(editor, 'customLink', linkIcon, 'Link', 'mceLink');
          },
        }}
      />
      <div>
        <button className={style.cancelButton}>취소</button>
        <button className={style.saveButton} onClick={saveContent}>
          저장
        </button>
      </div>
    </div>
  );
};

export default TinyMceEditor;
